function tin_check_login(){if(tin.uid>0){return true;}if($("div.overlay").length<=0){$("#content-container").append('<div class="overlay"></div>');}$("div.overlay").show(),$("body").addClass("fadeIn");$("#sign").removeClass("register").addClass("sign");$("div.overlay, form a.close").bind("click",function(){return $("body").removeClass("fadeIn"),$("#sign").removeAttr("class"),$("div.overlay").remove();});return false;}$(function(){$(".tooltip-trigger").each(function(d){if(this.title){var f=this.title;var e=5;$(this).mouseover(function(a){this.title="";$(this).append('<div class="tooltip top" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner">'+f+"</div></div>");$(".tooltip").css({left:(($(this).width()-$(".tooltip").width())/2)+"px",bottom:($(this).height()+e)+"px"}).addClass("in").fadeIn(250);}).mouseout(function(){this.title=f;$(".tooltip").remove();});}});});$(document).on("click","#content-index-control",function(){if($("#content-index-control").hasClass("open")){$("#content-index-control").html("[展开]");$("#content-index-control").removeClass("open");$("#index-ul").css("display","none");}else{$("#content-index-control").html("[收起]");$("#content-index-control").addClass("open");$("#index-ul").css("display","block");}});$(function(){a();function a(){$(window).scroll(function(){var d=$(window).scrollTop();if($(".floatwidget").length>0){var f=$(".floatwidget").offset(),c=$(".floatwidget").height(),h=f.top+c+60;var g=$("#main-wrap").height(),b=$("#main-wrap").offset(),i=b.top+g;maxh=c+d+110;if(d>h){if($(".floatwidget-container").html()==""){$(".floatwidget").clone().prependTo($(".floatwidget-container"));}$(".floatwidget-container").fadeIn("slow");if(maxh>i){var e=i-maxh+80;$(".floatwidget-container").css("top",e);}else{$(".floatwidget-container").css("top",80);}}else{$(".floatwidget-container").html("").fadeOut("slow");}}d>200?$("span[id=back-to-top]").fadeIn("slow"):$("span[id=back-to-top]").fadeOut("slow");(d>60&&screen.width>640)?$("#nav-scroll").addClass("tofix"):$("#nav-scroll").removeClass("tofix");});$("#back-to-top").click(function(){$("html,body").animate({scrollTop:0},1000);});}});$(".like-btn").click(function(){var d=$(this);var b=d.attr("pid");var c="tin_post_like_"+b;var a=tinGetCookie(c);if(d.hasClass("love-yes")||a.length>0){return;}$.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"json",url:tin.ajax_url,data:"action=like&pid="+b,cache:false,success:function(f){var e=d.children("span").text();d.children("span").text(Number(e)+1);d.addClass("love-animate").attr("title","已喜欢");tinSetCookie(c,1,3600,tin.home);setTimeout(function(){d.removeClass("love-animate").addClass("love-yes");},500);if(f.get===1){tinAlert("参与文章互动获取"+f.credit+"积分");}}});});$(".collect").click(function(){if(!tin_check_login()){return;}var c=$(this);var a=Number(c.attr("pid"));if(c.attr("uid")&&c.hasClass("collect-no")){var b=Number(c.attr("uid"));$.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"html",url:tin.ajax_url,data:"action=collect&uid="+b+"&pid="+a+"&act=add",cache:false,success:function(){c.children("span").text("已收藏");c.addClass("collect-animate").attr("title","已收藏");setTimeout(function(){c.removeClass("collect-animate").removeClass("collect-no").addClass("collect-yes");},500);}});return false;}else{if(c.attr("uid")&&c.hasClass("remove-collect")){var b=Number(c.attr("uid"));$.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"html",url:tin.ajax_url,data:"action=collect&uid="+b+"&pid="+a+"&act=remove",cache:false,success:function(){c.children("span").text("点击收藏");c.addClass("collect-animate").attr("title","点击收藏");setTimeout(function(){c.removeClass("collect-animate").removeClass("remove-collect").removeClass("collect-yes").addClass("collect-no");},500);}});return false;}else{return;}}});$(".cmt-vote i").click(function(){var f=$(this);var e=f.attr("data"),c=f.attr("data-type"),b=f.attr("data-num"),d="tin_comment_vote_"+e,a=tinGetCookie(d);if(f.parent(".cmt-vote").hasClass("voted")||a.length>0){return;}$.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"html",url:tin.ajax_url,data:"action=commentvote&cid="+e+"&type="+c,cache:false,success:function(){b=Number(b)+1;f.text(" ["+b+"]");f.parent(".cmt-vote").addClass("voted");f.addClass("voted");tinSetCookie(d,c,3600,tin.home);}});return false;});var weixinTimer=null;$(".weixin-btn").hover(function(){clearTimeout(weixinTimer);$("#weixin-qt").css("display","block").stop().animate({top:40,opacity:1},500);},function(){weixinTimer=setTimeout(function(){$("#weixin-qt").fadeOut(100,function(){$(this).css("top",80);});},100);});$(".as-weixin,.as-donate").bind("mouseover",function(){$(this).children(".as-qr").css("display","block").stop().animate({bottom:30,opacity:1},500);}).bind("mouseleave",function(){$(this).children(".as-qr").hide().css("bottom",60);});$(".as-donate").bind("click",function(){if($(this).parent(".social-icon-wrap").children("form#alipay-gather").length>0){$(this).parent(".social-icon-wrap").children("form#alipay-gather").submit();}});var floatbtnqrTimer=null;$("#qr").hover(function(){clearTimeout(floatbtnqrTimer);$("#floatbtn-qr").css("display","block").stop().animate({left:-140,opacity:1},500);},function(){floatbtnqrTimer=setTimeout(function(){$("#floatbtn-qr").fadeOut(100,function(){$(this).css("left",-180);});},100);});$("#layoutswt").click(function(){if($("#layoutswt i").hasClass("is_blog")){window.location.href=$("#layoutswt i").attr("src")+"?layout=cms";}else{if($("#layoutswt i").hasClass("is_cms")){window.location.href=$("#layoutswt i").attr("src")+"?layout=blocks";}else{window.location.href=$("#layoutswt i").attr("src")+"?layout=blog";}}});$("#main-wrap img.avatar").mouseover(function(){$(this).addClass("avatar-rotate");});$("#main-wrap img.avatar").mouseout(function(){$(this).removeClass("avatar-rotate");});window.onload=function(){$("#bdshare_s").html("");};$(function(){function b(h,g,l){if(document.selection){h.focus();sel=document.selection.createRange();l?sel.text=g+sel.text+l:sel.text=g;h.focus();}else{if(h.selectionStart||h.selectionStart=="0"){var k=h.selectionStart;var j=h.selectionEnd;var i=j;l?h.value=h.value.substring(0,k)+g+h.value.substring(k,j)+l+h.value.substring(j,h.value.length):h.value=h.value.substring(0,k)+g+h.value.substring(j,h.value.length);l?i+=g.length+l.length:i+=g.length-j+k;if(k==j&&l){i-=l.length;}h.focus();h.selectionStart=i;h.selectionEnd=i;}else{h.value+=g+l;h.focus();}}}var c=document.getElementById("comment")||0;var a={strong:function(){b(c,"<strong>","</strong>");},em:function(){b(c,"<em>","</em>");},del:function(){b(c,"<del>","</del>");},underline:function(){b(c,"<u>","</u>");},quote:function(){b(c,"<blockquote>","</blockquote>");},aprivate:function(){b(c,"[private]","[/private]");},ahref:function(){var e=prompt("请输入链接地址","http://");var d=prompt("请输入链接描述","");if(e){b(c,'<a target="_blank" href="'+e+'" rel="external">'+d+"</a>","");}},img:function(){var d=prompt("请输入图片地址","http://");if(d){b(c,'<img src="'+d+'" alt="" />',"");}},code:function(){b(c,"<code>","</code>");},php:function(){b(c,'<pre class="prettyprint linenums php" >',"</pre>");},js:function(){b(c,'<pre class="prettyprint linenums js" >',"</pre>");},css:function(){b(c,'<pre class="prettyprint linenums css" >',"</pre>");}};window.SIMPALED={};window.SIMPALED["Editor"]=a;});$(".stars").mouseover(function(){if($(".rates").hasClass("rated")){return;}else{$(".stars").children("i").removeClass("fa-star").addClass("fa-star-o");$(this).prevAll().children("i").removeClass("fa-star-o").addClass("fa-star");$(this).children("i").removeClass("fa-star-o").addClass("fa-star");}});$(".stars").click(function(){if($(".rates").hasClass("rated")){return;}else{$(".rates").addClass("rated");var a=$(this).attr("id");var h=$(".rates").attr("pid");var j=$(this).attr("times");j=Number(j)+1;$(this).attr("times",j);var i=$("#star1").attr("times");var g=$("#star2").attr("times");var e=$("#star3").attr("times");var d=$("#star4").attr("times");var c=$("#star5").attr("times");var b=Number(i)+Number(g)+Number(e)+Number(d)+Number(c);var f=Number(i)*1+Number(g)*2+Number(e)*3+Number(d)*4+Number(c)*5;ra=f/b;ra=ra.toFixed(1);function k(l){allt=$(".ratingCount").html();allt=Number(allt)+1;$(".ratingCount").html(allt);$(".ratingValue").html(l);}jQuery.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"html",url:tin.ajax_url,data:"action=rating&sid="+a+"&pid="+h,cache:false,success:k(ra)});}});$(".stars").mouseout(function(){function a(b){if($(b).attr("solid")=="y"){$(b).children().attr("class","fa fa-star");}else{$(b).children().attr("class","fa fa-star-o");}}if($(".rates").hasClass("rated")){return;}else{a("#starone");a("#startwo");a("#starthree");a("#starfour");a("#starfive");}});var errTimer=null;$("#submit-mail").click(function(){$(".err").hide();name=$("#t-name").val();mail=$("#t-email").val();comment=$("#t-comment").val();num1=$("input#t-num1").val();num2=$("input#t-num2").val();sum=$("input#captcha2").val();clearTimeout(errTimer);if(name==""){$(".err").html("姓名不能为空").slideToggle(1000);$("input#t-name").focus();errTimer=setTimeout(function(){$(".err").slideToggle(1000);},3000);return false;}if(mail==""){$(".err").html("邮箱地址不能为空").slideToggle(1000);$("input#t-email").focus();errTimer=setTimeout(function(){$(".err").slideToggle(1000);},3000);return false;}if(!mail.match("^([a-zA-Z0-9_-])+((.)?([a-zA-Z0-9_-])+)+@([a-zA-Z0-9_-])+(.([a-zA-Z0-9_-])+)+$")){$(".err").html("邮箱地址格式不正确").slideToggle(1000);$("input#t-email").focus();errTimer=setTimeout(function(){$(".err").slideToggle(1000);},3000);return false;}if(sum==""){$(".err").html("验证码不能为空").slideToggle(1000);$("input#captcha2").focus();errTimer=setTimeout(function(){$(".err").slideToggle(1000);},3000);return false;}if(Number(num1)+Number(num2)!=Number(sum)){$(".err").html("验证码不正确").slideToggle(1000);$("input#captcha2").focus();errTimer=setTimeout(function(){$(".err").slideToggle(1000);},3000);return false;}if(comment==""){$(".err").html("消息内容不能为空").slideToggle(1000);$("textarea#t-comment").focus();errTimer=setTimeout(function(){$(".err").slideToggle(1000);},3000);return false;}$("input#submit-mail").css({color:"#fff",background:"#1cbdc5"}).val("正在发送");$.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"html",url:tin.ajax_url,data:"action=message&tm="+mail+"&tn="+name+"&tc="+comment,cache:false,success:a()});function a(){errTimer=setTimeout(function(){$("#mailmessage").html('<p class="mail-success"><i class="fa fa-check"></i>消息发送成功,你也可以扫描下方微信二维码并随时与我联系.</p><div><img src="'+tin.tin_url+'/images/weixin.png"></div>');},2000);}return false;});var dlmsgTimer=null;$(".mail-dl-btn").click(function(){$(".dl-msg").hide();mail=$(".mail-dl").val();pid=$(".dl-mail").attr("pid");clearTimeout(dlmsgTimer);if(mail==""){$(".dl-msg").html("邮箱地址不能为空").slideToggle(1000);$("input.mail-dl").focus();dlmsgTimer=setTimeout(function(){$(".dl-msg").slideToggle(1000);},3000);return false;}if(!mail.match("^([a-zA-Z0-9_-])+((.)?([a-zA-Z0-9_-])+)+@([a-zA-Z0-9_-])+(.([a-zA-Z0-9_-])+)+$")){$(".dl-msg").html("邮箱地址格式不正确").slideToggle(1000);$("input.mail-dl").focus();dlmsgTimer=setTimeout(function(){$(".dl-msg").slideToggle(1000);},3000);return false;}if(!document.getElementById("dl-terms-chk").checked){$(".dl-msg").html("你必须同意勾选下载条款").slideToggle(1000);dlmsgTimer=setTimeout(function(){$(".dl-msg").slideToggle(1000);},3000);return false;}$.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"html",url:tin.ajax_url,data:"action=maildownload&mail="+mail+"&pid="+pid,cache:false,success:a()});function a(){dlmsgTimer=setTimeout(function(){$(".sg-dl").html('<span><p class="mail-dl-success"><i class="fa fa-check"></i>请求发送成功,请稍候检查你的收件箱.如果长时间未收到,请检查垃圾箱或者直接通过下方网站下方消息框发送包含该文章链接的邮件消息给我，我会及时处理回复.你也可以扫描下方微信二维码并随时与我联系.</p></span><div><img src="'+tin.tin_url+'/images/weixin.png"></div>');$.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"html",url:tin.ajax_url,data:"action=whodownload&mail="+mail+"&pid="+pid,cache:false});},2000);}return false;});$(".downldlink").click(function(){metakey=$(this).attr("id");pid=$(".downldlinks-inner").attr("pid");$.ajax({type:"POST",xhrFields:{withCredentials:true},dataType:"html",url:tin.ajax_url,data:"action=downldtimes&key="+metakey+"&pid="+pid,cache:false});});$(".buysaledl").click(function(){sid=$(this).attr("id");pid=$(".downldlinks-inner").attr("pid");uid=$(".downldlinks-inner").attr("uid");var a=0;$.ajax({type:"POST",dataType:"json",url:tin.ajax_url,data:"action=checklogin",cache:false,success:function(b){a=b.status;if(a!=0){$.ajax({type:"POST",dataType:"json",url:tin.ajax_url,data:"action=popsaledl&sid="+sid+"&pid="+pid+"&uid="+uid,cache:false,success:function(c){$(".buy-pop-out").fadeIn("fast");$(".confirm-buy").html('<button class="cancel-to-back btn btn-warning">取消</button>');$(".cancel-to-back").click(function(){$(".buy-pop-out").fadeOut();});$(".dl-price").html(c.price);$(".all-credits").html(c.credit);enough=Number(c.enough);if(enough==0){$(".saledl-msg").html(c.msg);}else{$(".saledl-msg").html("");$(".confirm-buy").prepend('<button class="yes-to-buy btn btn-success" sid="'+c.sid+'">确定</button>');$(".yes-to-buy").click(Confirm_to_buy);}}});}else{$(".buy-pop-out").fadeIn("fast");$(".confirm-buy").html('<button class="cancel-to-back btn btn-warning">返回</button>');$(".cancel-to-back").click(function(){$(".buy-pop-out").fadeOut();});$(".buy-des").html("<p>出错了！</p><p>Wordpress未检测到登录，可能你已从别的本站页面注销，请刷新网页并重新登录！</p>");}}});});function Confirm_to_buy(){sid=$(this).attr("sid");pid=$(".downldlinks-inner").attr("pid");uid=$(".downldlinks-inner").attr("uid");$.ajax({type:"POST",dataType:"json",url:tin.ajax_url,data:"action=confirmbuy&sid="+sid+"&pid="+pid+"&uid="+uid,cache:false,success:function(a){a.success=Number(a.success);if(a.success==1){info="<p>购买成功，已扣除你<span>"+a.price+"</span>积分，当前你还剩余<span>"+a.credit+"</span>积分</p><p>同时系统也通过邮件发送下载链接至你在本站资料中所保留的邮箱，以备不时之需！";}else{if(a.success==2){info="<p>你似乎已购买过该资源，请刷新页面查看！</p><p>请不要多次点击购买，以免重复扣除积分，如果有积分错误，请站内信或通过邮件消息工具通知管理员！</p>";}else{info="<p>购买失败，请重新再试！</p><p>如果你发现积分重复扣除或多扣等错误，请站内信或通过邮件消息工具通知管理员！</p>";}}$(".buy-des").html(info);$(".confirm-buy").html('<button class="cancel-to-back btn btn-success">返回</button>');$(".cancel-to-back").click(function(){$(".buy-pop-out").fadeOut();});setTimeout(function(){$(".buy-pop-out").fadeOut("fast");location.reload();},3000);}});}$(".alert_close, .alert_cancel .btn").click(function(){$(".tinalert").fadeOut();});function tinAlert(a){var b='<div class="tinalert"><div class="alert_title"><h4>来自网页的提醒</h4></div><div class="alert_content"><p>'+a+'</p></div><div class="alert_cancel"><button class="cancel-to-back btn btn-danger">确定</button></div><span class="alert_close"><i class="fa fa-close"></i></span></div>';$("body").append(b);$(".alert_close, .alert_cancel .btn").bind("click",function(){$(".tinalert").fadeOut().remove();});$(".tinalert").fadeIn();}var tinRefreshIcon='<i class="fa fa-spinner fa-spin" style="margin-right:4px;line-height:20px;font-size:20px;font-size:2rem;"></i>';function tin_do_post(c,a,b,d){$(c).find('[type="submit"]').addClass("disabled").prepend(tinRefreshIcon);$.ajax({type:"POST",url:a,data:b,success:function(e){$(d).html($(e).find(d).html());},error:function(){tin_do_post(c,a,b,d);}});}$("#pmform").submit(function(){var a="#pmform";var b=$(a);tin_do_post(a,location.href,{pmNonce:b.find('[name="pmNonce"]').val(),pm:b.find('[name="pm"]').val()},".content");return false;});$("#creditform").submit(function(){var c="#creditform";var e=$(c);var d;var b;d=document.getElementsByName("creditChange");if(d){for(var a=0;a<d.length;a++){if(d[a].checked){b=d[a].getAttribute("value");}else{b="add";}}}else{b="add";}tin_do_post(c,location.href,{creditNonce:e.find('[name="creditNonce"]').val(),creditChange:b,creditNum:e.find('[name="creditNum"]').val(),creditDesc:e.find('[name="creditDesc"]').val()},".content");return false;});$("#promoteform").submit(function(){var c="#promoteform";var e=$(c);var d;var b;d=document.getElementsByName("promote_type");if(d){for(var a=0;a<d.length;a++){if(d[a].checked){b=d[a].getAttribute("value");}else{b="once";}}}else{b="once";}tin_do_post(c,location.href,{promoteNonce:e.find('[name="promoteNonce"]').val(),promote_code:e.find('[name="promote_code"]').val(),promote_type:b,discount_value:e.find('[name="discount_value"]').val(),expire_date:e.find('[name="expire_date"]').val()},".content");return false;});$(".delete_promotecode").on("click",function(){var c=$(this).parent("tr").children("input[name=promote_id]");var b=c.val();var a=$(".promote-table input[name=dpromoteNonce]").val();$.ajax({type:"POST",url:location.href,data:{promote_id:b,dpromoteNonce:a},success:function(d){$(".content").html($(d).find(".content").html());},error:function(){tinAlert("删除失败,请重新再试");}});return false;});$("button#subscribe").click(function(){email=$("input#subscribe").val();if(email==""||(!email.match("^([a-zA-Z0-9_-])+((.)?([a-zA-Z0-9_-])+)+@([a-zA-Z0-9_-])+(.([a-zA-Z0-9_-])+)+$"))){$("#subscribe-msg").html("请输入正确邮箱").slideToggle("slow");setTimeout(function(){$("#subscribe-msg").slideToggle("slow");},2000);}else{$.ajax({type:"POST",dataType:"json",url:tin.ajax_url,data:"action=subscribe&email="+email,cache:false,success:function(){$("#subscribe-span").html("你已成功订阅该栏目，同时你也会收到一封提醒邮件.");}});}});$("button#unsubscribe").click(function(){email=$("input#unsubscribe").val();if(email==""||(!email.match("^([a-zA-Z0-9_-])+((.)?([a-zA-Z0-9_-])+)+@([a-zA-Z0-9_-])+(.([a-zA-Z0-9_-])+)+$"))){$("#unsubscribe-msg").html("请输入正确邮箱").slideToggle("slow");setTimeout(function(){$("#unsubscribe-msg").slideToggle("slow");},2000);}else{$.ajax({type:"POST",dataType:"json",url:tin.ajax_url,data:"action=unsubscribe&email="+email,cache:false,success:function(a){$("#unsubscribe-span").html(a.msg);}});}});function tinSetCookie(b,c,a,e){var d=new Date();d.setTime(d.getTime()+a*1000);document.cookie=b+"="+escape(c)+((a==null)?"":";expires="+d.toGMTString())+((e==null)?"":";path="+e);}function tinGetCookie(a){if(document.cookie.length>0){c_start=document.cookie.indexOf(a+"=");if(c_start!=-1){c_start=c_start+a.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length;}return unescape(document.cookie.substring(c_start,c_end));}}return"";}function set_tin_nonce(){$.ajax({type:"POST",url:tin.ajax_url,data:{action:"tin_create_nonce"},success:function(a){tinSetCookie("tin_check_nonce",$.trim(a),3600,tin.home);},error:function(){set_tin_nonce();}});}var wpnonce=tinGetCookie("tin_check_nonce");if(wpnonce==null||wpnonce==""){set_tin_nonce();}function update_tin_traffic(a,b){$.ajax({type:"POST",url:tin.ajax_url,data:{action:"tin_tracker_ajax",type:a,pid:b,wp_nonce:tinGetCookie("tin_check_nonce")},success:function(c){if($.trim(c)==="NonceIsInvalid"){set_tin_nonce();update_tin_traffic(a,b);}},error:function(){update_tin_traffic(a,b);}});}function tinGetQueryString(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");var c=window.location.search.substr(1).match(b);if(c!=null){return unescape(c[2]);}return null;}$(".search-btn-click").bind("click",function(){if($(".header-search-slide").css("display")=="none"){$(this).css({background:"#fafafa"});$(".header-search-slide").slideDown();$(".header-search-slide").children().children("input").focus();}});$(".header-search-slide").children().children("input").bind("blur",function(){$(".search-btn-click").css({background:"transparent"});$(".header-search-slide").slideUp();});var opened=false;$(".toggle-menu").bind("click",function(a){if(screen.width>640){$("#pri-nav ul").slideToggle();}$("#content-container").toggleClass("push");$("#navmenu-mobile-wraper").toggleClass("push");if(opened){opened=false;setTimeout(function(){$("#navmenu-mobile").removeClass("push");},500);}else{$("#navmenu-mobile").addClass("push");opened=true;}});$("#main-wrap").bind("click",function(){if(screen.width<=640&&opened==true){$("#content-container").toggleClass("push");$("#navmenu-mobile-wraper").toggleClass("push");setTimeout(function(){$("#navmenu-mobile").removeClass("push");},500);opened=false;}});$("#page-sort-menu-btn a").click(function(){$(".pagesidebar ul").slideToggle();});$(".menu-item-has-children").bind("mouseover",function(){if(screen.width>640&&!$(this).children("ul").is(":animated")){$(this).children("ul").slideDown();}}).bind("mouseleave",function(){if(screen.width>640){$(this).children("ul").slideUp();}});$(".login-yet-click").bind("mouseover",function(){if(!$(this).children(".user-tabs").is(":animated")){$(this).children(".user-tabs").slideDown();}}).bind("mouseleave",function(){$(this).children(".user-tabs").slideUp();});$("#focus-us").bind("mouseover",function(){if(!$(this).children("#focus-slide").is(":animated")){$(this).children("#focus-slide").slideDown();}}).bind("mouseleave",function(){$(this).children("#focus-slide").slideUp();});$(".comt-smilie").bind("click",function(){$("#comt-format").hide();$("#comt-smilie").toggle();});$(".comt-format").bind("click",function(){$("#comt-smilie").hide();$("#comt-format").toggle();});$("#edit-avatar").click(function(){$("#upload-input").slideToggle();});$("#upload-avatar").click(function(){var a=$("#upload-input input[type=file]").val();if(a==""){$("#upload-avatar-msg").html("请选择一个图片").slideDown();setTimeout(function(){$("#upload-avatar-msg").html("").slideUp();},2000);}else{document.getElementById("info-form").enctype="multipart/form-data";$("form#info-form").submit();}});$("[data-pop]").on("click",function(){var a=$(this).attr("data-pop");$("div.overlay").length<=0?$(".header-wrap").before('<div class="overlay"></div>'):$("div.overlay").show();$(".popupbox").hide(),$("#"+a).fadeIn();});$("[data-top]").on("click",function(){var a=$(this).attr("data-top");"true"==a&&$("body,html").animate({scrollTop:0},0);});$("body").on("click","div.overlay,a.popup-close",function(){$("div.popupbox, div.overlay").fadeOut();});function calculate(){$("#total-price").find("strong").text("￥"+Number($("#order_quantity").val()*$("#order_price").val()).toFixed(2));}$("div.amount-number a").on("click",function(a){a.preventDefault(),fieldName=$(this).attr("field"),fieldstyle=$(this).attr("id");var f=parseInt($("input[name="+fieldName+"]").val());var e=parseInt($("li.summary-amount span.dt-num").text());"plus"==fieldstyle?Number(f)>=e?$("input[name="+fieldName+"]").val(e):isNaN(f)?$("input[name="+fieldName+"]").val(0):$("input[name="+fieldName+"]").val(f+1):"minus"==fieldstyle&&(!isNaN(f)&&f>1?$("input[name="+fieldName+"]").val(f-1):$("input[name="+fieldName+"]").val(1));}),$("input[name=amountquantity]").keyup(function(){var b=$(this).val();var a=parseInt($("li.summary-amount span.dt-num").text());if(!/^(\+|-)?\d+$/.test(b)||0>=b){$(this).val(1);}if(a<b){$(this).val(a);}}),$("a.buy-btn").on("click",function(a){a.preventDefault(),$("input[name=order_quantity]").val($("input[name=amountquantity]").val()),calculate();}),$("#order_quantity").keyup(function(){var a=$(this).val();""==a?$(this).val(1):($("#pay-submit").removeAttr("disabled"),(!/^(\+|-)?\d+$/.test(a)||0>=a)&&$(this).val(1)),calculate();});$("#pay-submit").on("click",function create_order(){var i=$(this);if(i.hasClass("disabled")){return;}i.addClass("disabled").prepend(tinRefreshIcon);var g=$("input#product_id").val(),m=$("input#promote_code").val(),h=$("input#order_name").val(),k=$("input#order_quantity").val(),l=$("input#receive_name").val(),d=$("input#receive_address").val(),f=$("input#receive_zip").val(),c=$("input#receive_email").val(),a=$("input#receive_phone").val(),j=$("input#receive_mobile").val(),e=$("input[name=order_body]").val(),b=$("input[name=order_nonce]").val();if(l==""||c==""){alert("收货人姓名或邮箱不能为空");i.removeClass("disabled").text("立即付款");return false;}else{if(!c.match("^([a-zA-Z0-9_-])+((.)?([a-zA-Z0-9_-])+)+@([a-zA-Z0-9_-])+(.([a-zA-Z0-9_-])+)+$")){alert("收货人邮箱格式不正确");i.removeClass("disabled").text("立即付款");return false;}}$.ajax({type:"POST",dataType:"json",async:false,url:tin.ajax_url,data:{action:"create_order",product_id:g,promote_code:m,order_name:h,order_quantity:k,receive_name:l,receive_address:d,receive_zip:f,receive_email:c,receive_phone:a,receive_mobile:j,order_msg:e,wp_nonce:b},success:function(n){if($.trim(n.msg)=="NonceIsInvalid"){tinAlert("安全验证未通过,订单未被提交,请刷新页面再试");}else{if(n.success==0){tinAlert(n.msg);i.removeClass("disabled").text("立即付款");}else{if(n.redirect==0){location.replace(location.href);}else{if(n.redirect==1){$("input#order_id").val(n.order_id);$("form#alipayment").submit();}else{i.removeClass("disabled").text("立即付款");return;}}}}},});return false;});$(".close-order").bind("click",function(){var a=$(this);var b=a.attr("data");$.ajax({type:"POST",dataType:"json",async:false,url:tin.ajax_url,data:{action:"closeorder",id:b,},success:function(c){if(c.success==0){tinAlert(c.msg);}else{a.parent("td").prev().text("交易关闭");a.parent("td").html("");}}});});$(".continue-pay").bind("click",function(){var e=$(this);var f=e.attr("data-id"),c=$("#continue-pay"),d=c.children("input#product_id"),b=c.children("input#order_id"),a=c.children("input#order_name");$.ajax({type:"POST",dataType:"json",url:tin.ajax_url,data:{action:"continue_order",id:f},success:function(g){if(g.success==1&&g.order.order_currency=="credit"){e.parent("td").html("交易成功");return false;}else{if(g.success==1&&g.order.order_currency=="cash"){d.val(g.order.product_id);b.val(g.order.order_id);a.val(g.order.product_name);c.submit();}else{tinAlert(g.msg);return false;}}}});});$("#promote_code_apply").click(function(){var b=$("input#promote_code").val();var a=Number($("#order_quantity").val()*$("#order_price").val()).toFixed(2);if(b==""){return;}else{$.ajax({type:"POST",dataType:"json",async:false,url:tin.ajax_url,data:{action:"use_promote_code",promote_code:b,order_total_price:a},success:function(c){if(c.success==1){$("#promote_code,#promote_code_apply").css("display","none");$("#promote").append("应用优惠码成功,请直接提交支付");$("#total-price").find("strong").text("￥"+c.total_price);}else{tinAlert(c.msg);}},});}});$("#joinvip-submit").click(function create_vip_order(){$("#joinvip-submit").addClass("disabled").prepend(tinRefreshIcon);var c;var b=-1;c=document.getElementsByName("product_id");if(c){for(var a=0;a<c.length;a++){if(c[a].checked){b=c[a].getAttribute("value");}}}$.ajax({type:"POST",dataType:"json",async:false,url:tin.ajax_url,data:{action:"create_vip_order",product_id:b},success:function(d){$("#joinvip-submit").removeClass("disabled");$("#joinvip-submit i").remove();if(d.success==1){$("input#order_id").val(d.order_id);$("form#joinvip").attr("onsubmit","").submit();}else{tinAlert(d.msg);}},});return false;});$("#creditrechargesubmit").on("click",function(){var c=$("#creditrechargeform");c.find('[type="submit"]').addClass("disabled").prepend(tinRefreshIcon);var b=-4,a=c.find("input[name=creditrechargeNum]").val();$.ajax({type:"POST",dataType:"json",async:false,url:tin.ajax_url,data:{action:"create_credit_recharge_order",product_id:b,creditrechargeNum:Number(a)},success:function(d){if(d.success==1){c.find("input#order_id").val(d.order_id);c.attr("onsubmit","").submit();}else{tinAlert(d.msg);}},});return false;});$("a#daily_sign").bind("click",function(){var a=$(this);$.ajax({type:"POST",dataType:"json",async:false,url:tin.ajax_url,data:{action:"daily_sign"},success:function(b){if(b.success==1){a.attr({id:"daily_signed",title:"今日已签到"}).text("已签到");if(a.prev("a").length>0){var c=Number($.trim(a.prev("a").text()))+Number(b.credits);a.prev("a").text(" "+c);}else{tinAlert(b.msg);}}else{tinAlert(b.msg);}},});});$(document).ready(function(){$(".slider-video").find("span").bind("click",function(){var h=$(this).parent("a"),g=h.attr("data");if(h.find("embed").length==0){if($("#flexslider").children("ul").children("li").length>1){jQuery("#flexslider").flexslider("pause");}h.append('<embed src="'+g+'" width=100% height=100% align="middle" allowScriptAccess="never" allowNetworking="internal" allowfullscreen="true" autostart="0" type="application/x-shockwave-flash" flashvars="isShowRelatedVideo=false&showAd=0&isAutoPlay=true&isDebug=false" />');h.parent(".slider-video").addClass("playing");}else{$(this).parent("a").find("embed").remove();$(this).parent("a").parent(".slider-video").removeClass("playing");jQuery("#flexslider").flexslider("play");}});var a={api:"https://api.mrxn.net/mrxnqrapi/api.php?data=",url:window.location.href,exist:false,create:function(){if(!this.exist){var g=document.createElement("img");g.src=this.api+this.url;g.width=120;this.exist=true;return g;}}};document.getElementById("floatbtn-qr").insertBefore(a.create(),document.getElementById("floatbtn-qr-msg"));$(".toggle-click-btn").click(function(){$(this).next(".toggle-content").slideToggle("slow");if($(this).hasClass("yes")){$(this).removeClass("yes");$(this).addClass("no");}else{$(this).removeClass("no");$(this).addClass("yes");}});(function(){$("#archives span.al_mon").each(function(){var i=$(this).next().children("li").size();var j=$(this).text();$(this).html(j+"<em> ( "+i+" 篇文章 )</em>");});var h=$("#archives ul.al_post_list"),g=$("#archives ul.al_post_list:first");h.hide(1,function(){g.show();});$("#archives span.al_mon").click(function(){$(this).next().slideToggle("slow");return false;});$("#al_expand_collapse").toggle(function(){h.show();},function(){h.hide();});})();$("h3 a").click(function(){myloadoriginal=this.text;$(this).text("请稍等，正在努力加载中...");var g=this;setTimeout(function(){$(g).text(myloadoriginal);},2000);});$(".infobg-close").click(function(){$(this).parent(".contextual").fadeOut("slow");});function d(n,j,k,m){var q;var h=false;var i=document.getElementById("news-scroll-zone"+m);i.innerHTML+=i.innerHTML;i.onmouseover=function(){h=true;};i.onmouseout=function(){h=false;};i.scrollTop=0;function g(){q=setInterval(l,j);if(!h){i.scrollTop+=1;}}function l(){if(i.scrollTop%n!=0){i.scrollTop+=1;if(i.scrollTop>=i.scrollHeight/2){i.scrollTop=0;}}else{clearInterval(q);setTimeout(g,k);}}setTimeout(g,k);}if($("#news-scroll-zone").length>0){d(20,30,5000,"");}if($("img.box-hide")){$("img.box-hide").lazyload({placeholder:tin.tin_url+"/images/image-pending.gif",threshold:50,failure_limit:100,skip_invisible:false});}$(".tin_aff_url,.trackback-url,input[name=rss]").click(function(){$(this).select();});$(".quick-copy-btn").click(function(){$(this).parent().children("input").select();alert("请用CTRL+C复制");});if(tinGetQueryString("aff")){tinSetCookie("tin_aff",tinGetQueryString("aff"),86400,tin.home);}if(!(typeof(tin.Tracker)=="undefined")){update_tin_traffic(tin.Tracker.type,tin.Tracker.pid);}$(".commentbtn").click(function(){$("html,body").animate({scrollTop:$("#comments").offset().top},800);});$(".site_loading").fadeOut();$(".commenttitle span").click(function(g){$(".commenttitle span").removeClass("active");$(this).addClass("active");$(".commentlist").hide();$($(this).parent("a").attr("href")).fadeIn();g.preventDefault();});$(".stickys span.heading-text-cms").click(function(g){$(".stickys span.heading-text-cms").removeClass("active");$(this).addClass("active");$(".stickys-latest-list").hide();$($(this).attr("id")).fadeIn();g.preventDefault();});$("#menu-mobile li.menu-item-has-children").prepend('<span class="child-menu-block"></span>');$(".child-menu-block").on("click",function(){$(this).parent().children(".sub-menu").slideToggle();if($(this).parent().hasClass("expand")){$(this).parent().removeClass("expand");}else{$(this).parent().addClass("expand");}});var f=$("h1 a,h2 a,h3 a");f.each(function(){$(this).attr("target","_blank");});window.prettyPrint&&prettyPrint();$(function(){var i=$(".tin-tabs-nav"),h=i.children("li"),g=$(".tin-tabs-container");if(i.length>0){i.each(function(){var j=$(this);j.next().children(".tin-tab").stop(true,true).hide().siblings(j.find("a").attr("href")).show();j.children("li").first().addClass("active").stop(true,true).show();});}h.on("mouseover",function(k){var j=$(this);if(j.hasClass("active")){return;}j.siblings().removeClass("active").end().addClass("active");j.parent().next().children(".tin-tab").stop(true,true).hide().siblings(j.find("a").attr("href")).fadeIn();k.preventDefault();});h.on("click",function(j){j.preventDefault();});});$(function(){var h=$("#wrapnav ul.nav"),g=h.children("li");if(h.length>0){h.each(function(){var i=$(this);i.children("li").first().addClass("active");$(i.find("a").attr("href")).show();});}g.on("click",function(j){var i=$(this);if(i.hasClass("active")){return;}i.siblings().removeClass("active").end().addClass("active");i.parent().parent().next().children(".wrapbox").stop(true,true).hide().siblings(i.find("a").attr("href")).fadeIn();j.preventDefault();});});$("a[rel^='prettyPhoto']").prettyPhoto({theme:"pp_default",slideshow:3000,autoplay_slideshow:false});var e=0,c=false;function b(j,i){if(i&&i==1){j.preventDefault();}var h=$(".aload a"),g=$(".aload_loading");g.show();h.text("加载中...");$.ajax({type:"GET",async:false,url:h.attr("href")+"#fluid_blocks",dataType:"html",success:function(k){result=$(k).find("#fluid_blocks span.masonry-box");nextlink=$(k).find(".aload a").attr("href");e++;$("#fluid_blocks").append(result);setTimeout(function(){g.fadeOut();result.imagesLoaded(function(){result.fadeIn(1000);$("#fluid_blocks").masonry("appended",result);});if(nextlink!=undefined&&e<5){h.attr("href",nextlink);}else{if(nextlink!=undefined){h.attr("href",nextlink);g.remove();h.text("加载更多");$(".aload").fadeIn();}else{g.remove();h.remove();$(".aload").removeClass("aload").addClass("bload").fadeIn().html('<a style="cursor:default;">没有更多了...</a>');}}c=false;},200);}});}$(window).scroll(function(){if($("#fluid_blocks").length>0){$top=$("#fluid_blocks").offset().top;$h=$("#fluid_blocks").height();if(($(document).height()-$(this).scrollTop()-$(this).height()<100||$top+$h-$(this).scrollTop()<450)&&e<5&&c==false){c=true;b();}}});$(".aload a").on("click",function(g){b(g,1);});$(".box-control li").on("click",function(){var g=$("#"+$(this).attr("data"));$(this).parent().children("li").removeClass("active");$(this).addClass("active");$(".box").hide();g.show();});$("img.captcha_img").bind("click",function(){var g="/captcha?"+Math.random();$(this).attr("src",g);});});
